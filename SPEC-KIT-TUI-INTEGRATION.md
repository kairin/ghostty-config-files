# Spec-Kit Integration Plan: Modern TUI System

**Created**: 2025-11-18
**Purpose**: Formalize TUI redesign through spec-kit workflow
**Status**: Ready for `/speckit.constitution`

---

## ðŸŽ¯ Overview

We have:
1. âœ… **Ultra-think complete**: 6 agents analyzed TUI requirements in parallel
2. âœ… **Implementation plan ready**: 188KB of comprehensive documentation in /tmp/
3. âœ… **Proof-of-concept working**: demo-tui-static.sh validates core concepts
4. âœ… **Gum installed**: Modern TUI framework ready to use

Next: Use spec-kit workflow to formalize and implement the full system.

---

## ðŸ“‹ Spec-Kit Workflow for TUI Redesign

### Command 1: `/speckit.constitution`

**Purpose**: Establish TUI redesign principles in project constitution

**Key Principles to Add**:
1. **TUI Framework**: `gum` (Charm Bracelet) is the standard
2. **Box Drawing**: Adaptive UTF-8/ASCII with automatic detection
3. **Verification**: Real tests only, no hard-coded success messages
4. **Package Managers**: `uv` (Python), `fnm` (Node.js) exclusively
5. **Output Style**: Docker-like collapsible task summaries
6. **Logging**: Structured JSON + human-readable console output
7. **Architecture**: Modular lib/ structure (core, ui, tasks, verification)

**After execution**: Apply reconciliation matrix immediately.

---

### Command 2: `/speckit.specify`

**Feature Name**: "Modern TUI Installation System"

**Specification Summary**:

**Problem**:
- Current installation has broken box drawing characters
- No proper verification (hard-coded success messages)
- Verbose output not collapsible
- Inconsistent logging

**Solution**:
- Implement `gum`-based TUI with adaptive box drawing
- Real verification functions for all components
- Docker-like progressive summarization
- Modular architecture for maintainability

**Requirements**:
1. Adaptive UTF-8/ASCII box drawing (auto-detect terminal capability)
2. Real verification tests (check actual system state)
3. Collapsible output (completed tasks â†’ single-line summaries)
4. Task timing and progress indicators
5. Modular lib/ structure (easy to test and maintain)
6. `uv` for Python package management (10-100x faster)
7. `fnm` for Node.js management (already constitutional requirement)
8. Verbose mode (press 'v' to expand output)
9. Error recovery (clear suggestions for failures)
10. Idempotency (safe to re-run)

**Success Criteria**:
- âœ… No broken box characters across all terminals
- âœ… All verification tests pass (real state checks)
- âœ… Installation completes in <10 minutes
- âœ… Professional output (users love the experience)

**After execution**: Apply reconciliation matrix.

---

### Command 3: `/speckit.plan`

**Implementation Plan Overview**:

**Phase 1: Foundation (Week 1)**
- Install gum system-wide
- Create lib/ directory structure
- Implement adaptive box drawing (lib/ui/boxes.sh)
- Test across terminals (Ghostty, xterm, SSH)

**Phase 2: Verification Framework (Week 2)**
- Implement all verification functions (lib/verification/)
- Create health check system
- Add system state capture (JSON logs)
- Unit tests for each verification function

**Phase 3: Modular Architecture (Weeks 3-4)**
- Extract tasks to lib/tasks/ (ghostty.sh, zsh.sh, python_uv.sh, nodejs_fnm.sh, ai_tools.sh)
- Create task registry system
- Implement state management (resume capability)
- Add error handling framework

**Phase 4: TUI Integration (Week 5)**
- Implement progressive summarization (lib/ui/collapsible.sh)
- Add progress indicators and spinners
- Create verbose mode toggle
- Integrate all components

**Phase 5: Testing & Refinement (Week 6)**
- Cross-terminal testing
- Performance benchmarks
- User acceptance testing
- Documentation updates

**After execution**: Apply reconciliation matrix.

---

### Command 4: `/speckit.tasks`

**Task Breakdown** (will be generated by spec-kit):

Expected tasks:
1. Setup lib/ directory structure
2. Install gum via apt/snap
3. Implement lib/ui/boxes.sh (adaptive box drawing)
4. Implement lib/verification/unit_tests.sh
5. Create verification functions for each component
6. Extract installation tasks to lib/tasks/
7. Implement lib/ui/collapsible.sh
8. Create task registry system
9. Add state management (JSON-based)
10. Implement error handling framework
11. Refactor start.sh to use new architecture
12. Create test suite
13. Cross-terminal testing
14. Performance benchmarking
15. Documentation updates

**After execution**:
- Apply reconciliation matrix
- Optional: Run `/speckit.analyze` to check consistency

---

### Command 5: `/speckit.implement`

**Implementation Execution**:

The spec-kit will work through tasks.md, implementing each component systematically.

**Key Implementation Notes**:
- Use demo-tui-static.sh as reference for box drawing and verification
- Follow /tmp/TUI-SYSTEM-IMPLEMENTATION-PLAN.md for detailed guidance
- Verify each task with real tests (not hard-coded success)
- Commit after each major milestone with constitutional branch workflow

**After completion**:
- Final verification: All tests pass
- Delete /tmp/ TUI planning documents (consolidated into spec)
- Delete demo scripts (replaced by production code)
- Delete delete/ folder (spec-kit workflow complete)

---

## ðŸ”§ Reconciliation Matrix for TUI Spec

After EVERY spec-kit command, apply these corrections:

| Find | Replace |
|------|---------|
| `.runners-local/` | `.runners-local/` |
| `shadcn/ui` | `DaisyUI` |
| `Node.js 18+` | `Node.js latest (v25.2.0+)` |

**Additional TUI-specific checks**:
- Verify `gum` is mentioned (not whiptail, dialog, or other TUI tools)
- Verify `uv` for Python (not pip, pip3)
- Verify `fnm` for Node.js (not nvm)
- Verify modular lib/ architecture (not monolithic start.sh)

---

## ðŸ“š Reference Documents

All ultra-think analysis available in `/tmp/`:
1. `TUI-SYSTEM-IMPLEMENTATION-PLAN.md` - Master plan (43 KB)
2. `tui-framework-analysis.md` - Framework comparison (19 KB)
3. `collapsible-output-design.md` - Docker-like design (25 KB)
4. `box-drawing-solution.md` - Adaptive box solution (23 KB)
5. `verification-framework-design.md` - Real test design (31 KB)
6. `package-manager-integration.md` - uv & fnm integration (23 KB)
7. `installation-script-architecture.md` - Modular design (24 KB)

**Proof-of-concept demos**:
- `demo-tui.sh` - Interactive demo (requires TTY)
- `demo-tui-static.sh` - Static demo (works in scripts)

---

## âœ… Ready to Execute

**Current Status**:
- âœ… Gum installed and tested
- âœ… Box drawing works (no broken characters)
- âœ… Real verification functions work
- âœ… All planning documents ready
- âœ… Proof-of-concept validates approach

**Next Command**:
```
/speckit.constitution
```

**Prompt to use**:
```
I need to establish the project constitution for the ghostty-config-files TUI redesign.

CRITICAL CORRECTIONS (current repository reality):
- Use .runners-local/ NOT .runners-local/
- Use DaisyUI NOT shadcn/ui
- Use Node.js latest (v25.2.0+) NOT Node.js 18+
- Use gum (Charm Bracelet) for TUI
- Use uv for Python package management
- Use fnm for Node.js management (already required)
- Preserve docs/.nojekyll (CRITICAL for GitHub Pages)

Core TUI principles to establish:
1. TUI Framework: gum (Charm Bracelet) is the standard
2. Box Drawing: Adaptive UTF-8/ASCII with automatic detection
3. Verification: Real tests only (no hard-coded messages)
4. Output: Docker-like collapsible task summaries
5. Architecture: Modular lib/ structure (core, ui, tasks, verification)
6. Package Managers: uv (Python), fnm (Node.js) exclusively
7. Logging: Structured JSON + human-readable console
8. Error Handling: Clear recovery suggestions
9. Idempotency: Safe to re-run installations
10. Performance: <10 min total installation time

Reference documents available in /tmp/ for detailed specifications.
```

---

## ðŸŽ¯ Success Criteria

After completing all 5 spec-kit commands:
- [ ] Constitution includes TUI principles
- [ ] Specification defines modern TUI system
- [ ] Implementation plan has 6-week roadmap
- [ ] Tasks are actionable and testable
- [ ] Implementation completes successfully
- [ ] All verification tests pass (real state checks)
- [ ] No broken box characters
- [ ] Installation is beautiful and professional
- [ ] Documentation updated

**Then**: Delete planning artifacts and celebrate! ðŸŽ‰

---

**Ready to proceed with `/speckit.constitution`? Let's formalize this TUI redesign!**
