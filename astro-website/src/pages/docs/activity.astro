---
// docs/activity.astro - Project activity and commit statistics
import DocsLayout from '../../components/layout/DocsLayout.astro';
import CommitChart from '../../components/charts/CommitChart.astro';
import commitData from '../../data/commits.json';

// Calculate some statistics
const totalCommits = commitData.total;
const peakDay = commitData.peakDay;
const activeDays = commitData.byDate.length;
const avgCommitsPerDay = Math.round(totalCommits / activeDays);

// Find most active month
const mostActiveMonth = commitData.byMonth.reduce((max, m) =>
  m.count > max.count ? m : max, commitData.byMonth[0]
);
---

<DocsLayout title="Project Activity" description="Commit history and development statistics for Ghostty Config Files" ogImage="/og-activity.png">
  <h2>Development Overview</h2>
  <p>
    This project has seen active development since January 2025, with continuous improvements
    to the installation process, new features, and bug fixes.
  </p>

  <!-- Stats Cards -->
  <div class="stats stats-vertical lg:stats-horizontal shadow bg-base-100 w-full not-prose my-6">
    <div class="stat">
      <div class="stat-figure text-primary">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
        </svg>
      </div>
      <div class="stat-title">Total Commits</div>
      <div class="stat-value text-primary">{totalCommits}</div>
      <div class="stat-desc">Since January 2025</div>
    </div>

    <div class="stat">
      <div class="stat-figure text-secondary">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
        </svg>
      </div>
      <div class="stat-title">Active Days</div>
      <div class="stat-value text-secondary">{activeDays}</div>
      <div class="stat-desc">~{avgCommitsPerDay} commits/day</div>
    </div>

    <div class="stat">
      <div class="stat-figure text-accent">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" />
        </svg>
      </div>
      <div class="stat-title">Peak Day</div>
      <div class="stat-value text-accent">{peakDay.count}</div>
      <div class="stat-desc">{peakDay.date}</div>
    </div>
  </div>

  <h2>Monthly Commit Activity</h2>
  <p>
    The chart below shows the number of commits per month. November 2025 has been particularly
    active with major feature additions and improvements.
  </p>

  <div class="card bg-base-100 shadow-xl not-prose my-6">
    <div class="card-body">
      <CommitChart />
    </div>
  </div>

  <h2>Development Highlights</h2>

  <div class="timeline timeline-vertical not-prose my-6">
    <li>
      <div class="timeline-start timeline-box">Initial release</div>
      <div class="timeline-middle">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 text-primary">
          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z" clip-rule="evenodd" />
        </svg>
      </div>
      <div class="timeline-end">Jul 2025</div>
      <hr class="bg-primary"/>
    </li>
    <li>
      <hr class="bg-primary"/>
      <div class="timeline-start">Aug 2025</div>
      <div class="timeline-middle">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 text-primary">
          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z" clip-rule="evenodd" />
        </svg>
      </div>
      <div class="timeline-end timeline-box">Nerd Fonts integration</div>
      <hr class="bg-primary"/>
    </li>
    <li>
      <hr class="bg-primary"/>
      <div class="timeline-start timeline-box">AI tools (Claude, Gemini)</div>
      <div class="timeline-middle">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 text-primary">
          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z" clip-rule="evenodd" />
        </svg>
      </div>
      <div class="timeline-end">Sep 2025</div>
      <hr class="bg-primary"/>
    </li>
    <li>
      <hr class="bg-primary"/>
      <div class="timeline-start">Oct 2025</div>
      <div class="timeline-middle">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 text-primary">
          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z" clip-rule="evenodd" />
        </svg>
      </div>
      <div class="timeline-end timeline-box">Constitutional workflow agents</div>
      <hr class="bg-secondary"/>
    </li>
    <li>
      <hr class="bg-secondary"/>
      <div class="timeline-start timeline-box">Major UI overhaul + Documentation</div>
      <div class="timeline-middle">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 text-secondary">
          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z" clip-rule="evenodd" />
        </svg>
      </div>
      <div class="timeline-end">Nov 2025</div>
    </li>
  </div>

  <h2>Recent Activity</h2>
  <p>
    Most recent active dates with commit counts:
  </p>

  <div class="overflow-x-auto not-prose my-6">
    <table class="table table-zebra table-sm">
      <thead>
        <tr>
          <th>Date</th>
          <th>Commits</th>
          <th>Activity</th>
        </tr>
      </thead>
      <tbody>
        {commitData.byDate.slice(-10).reverse().map(day => (
          <tr>
            <td>{day.date}</td>
            <td>{day.count}</td>
            <td>
              <progress
                class="progress progress-primary w-32"
                value={day.count}
                max={peakDay.count}
              />
            </td>
          </tr>
        ))}
      </tbody>
    </table>
  </div>

  <h2>Contributing</h2>
  <p>
    Want to contribute? Check out the
    <a href="https://github.com/kairin/ghostty-config-files" target="_blank" rel="noopener">GitHub repository</a>
    for issues and pull requests.
  </p>
</DocsLayout>
