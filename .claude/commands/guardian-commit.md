---
description: Fully automatic constitutional Git commit - analyzes changes, generates commit message, creates branch, commits, merges to main - FULLY AUTOMATIC
---

## Purpose

**AUTO-COMMIT**: Analyze uncommitted changes, generate perfect commit message, execute constitutional workflow with zero manual intervention.

## User Input

```text
$ARGUMENTS
```

**Note**: User input is OPTIONAL. If provided, used as additional context for commit message.

## Automatic Workflow

You **MUST** invoke the **001-orchestrator** agent to coordinate the auto-commit workflow.

Pass the following instructions to 001-orchestrator:

### Phase 1: Change Analysis (Parallel - 2 Tasks)

**Task 1: Git Status Analysis**
```bash
# Identify all changes
git status --porcelain
git status --short

# Separate staged vs unstaged
git diff --cached --name-only  # Staged files
git diff --name-only           # Unstaged files
```

**Task 2: Change Content Analysis**
```bash
# Analyze what changed
git diff --cached              # Staged content
git diff                       # Unstaged content

# Get file statistics
git diff --cached --stat
git diff --stat
```

**Output Required**:
- List of modified files (with paths)
- Type of changes (add/modify/delete)
- Lines changed per file
- Content summary

### Phase 2: Auto-Generate Commit Details (Single Task)

**Automatic Detection Rules**:

**Commit Type** (auto-detect based on files):
```
If files match:
  .claude/agents/*.md ‚Üí feat (agent system)
  .claude/commands/*.md ‚Üí feat (slash commands)
  website/src/**/*.md ‚Üí docs (documentation)
  website/src/**/*.astro ‚Üí feat (website features)
  scripts/*.sh ‚Üí feat (scripts) or fix (bug fixes)
  .runners-local/** ‚Üí ci (CI/CD changes)
  docs/** ‚Üí build (Astro build output)
  *.md (root) ‚Üí docs (documentation)
  AGENTS.md, README.md ‚Üí docs (core documentation)
```

**Scope** (auto-extract):
- From directory: .claude/agents/ ‚Üí scope: agents
- From directory: .claude/commands/ ‚Üí scope: commands
- From directory: website/src/ ‚Üí scope: website
- From directory: scripts/ ‚Üí scope: scripts
- From file type: Multiple types ‚Üí scope: repo

**Short Description** (auto-generate):
```
Extract from:
1. File names (remove extensions, join with dashes)
2. Common theme (e.g., "guardian-commands-enhancement")
3. Primary change (e.g., "001-orchestrator-integration")

Format: kebab-case, 2-5 words max
Examples:
  - "guardian-commands-update"
  - "astro-ui-redesign"
  - "agent-system-expansion"
```

**Commit Message** (auto-generate):
```
Format:
type(scope): Brief summary (max 72 chars)

Problem/Context:
- Why this change was needed
- What issue it solves

Solution:
- What was changed
- Key improvements made

Technical Details:
- Files modified count
- Lines added/removed
- Major components affected

Validation:
- How it was tested
- Expected behavior

ü§ñ Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>
```

**Example Auto-Generation**:
```
Files changed:
  .claude/commands/guardian-deploy.md (+150 lines)
  .claude/commands/guardian-cleanup.md (+100 lines)

Auto-detected:
  Type: feat (new features in commands)
  Scope: commands (files in .claude/commands/)
  Description: guardian-commands-enhancement

Generated message:
feat(commands): Enhance guardian commands with 001-orchestrator

Problem:
- Guardian commands executed agents sequentially
- No clear separation of concerns
- Overlapping functionality

Solution:
- All commands now invoke 001-orchestrator
- Clear phase-based execution
- Parallel agent coordination where safe

Technical Details:
- 2 files modified
- +250 lines added
- Enhanced /guardian-deploy with 7-phase workflow
- Enhanced /guardian-cleanup with automatic detection

Validation:
- Command descriptions updated
- Output format standardized
- Constitutional compliance maintained
```

### Phase 3: Constitutional Git Workflow (Sequential)

**Agent**: **002-git**

**Automatic Execution**:
```bash
# 1. Create timestamped branch
DATETIME=$(date +"%Y%m%d-%H%M%S")
TYPE="<auto-detected-type>"
DESCRIPTION="<auto-generated-description>"
BRANCH="${DATETIME}-${TYPE}-${DESCRIPTION}"

git checkout -b "$BRANCH"

# 2. Stage all changes
git add .

# 3. Commit with auto-generated message
git commit -m "<auto-generated-message>"

# 4. Push to remote
git push -u origin "$BRANCH"

# 5. Merge to main
git checkout main
git merge "$BRANCH" --no-ff -m "Merge branch '$BRANCH' into main"

# 6. Push main
git push origin main

# 7. Return to feature branch (NEVER delete)
git checkout "$BRANCH"
```

**Constitutional Requirements**:
- ‚úÖ Branch naming: YYYYMMDD-HHMMSS-type-description
- ‚úÖ Commit message: Multi-paragraph with context
- ‚úÖ Claude attribution: Automatic footer
- ‚úÖ Branch preservation: NEVER delete
- ‚úÖ Merge strategy: --no-ff (preserve history)

## Expected Output

```
ü§ñ AUTOMATIC COMMIT COMPLETE

Change Analysis:
- Files modified: 2
- Lines added: +250
- Lines removed: -15
- Net change: +235 lines

Auto-Generated Details:
Type: feat
Scope: commands
Branch: 20251115-143000-feat-guardian-commands-enhancement
Message: "feat(commands): Enhance guardian commands with 001-orchestrator"

Git Workflow:
- ‚úÖ Branch created and pushed to origin
- ‚úÖ Changes committed with constitutional format
- ‚úÖ Merged to main with --no-ff
- ‚úÖ Main pushed to remote
- ‚úÖ Branch preserved (not deleted)

Constitutional Compliance: ‚úÖ 100%
```

## When to Use

Run `/guardian-commit` when you have:
- Source code changes ready to commit
- Documentation updates to save
- Configuration file modifications
- Any uncommitted changes needing constitutional commit

**Perfect for**: Quick commits without thinking about branch names or commit messages.

## What This Command Does NOT Do

- ‚ùå Does NOT deploy to GitHub Pages (use `/guardian-deploy`)
- ‚ùå Does NOT clean up redundant files (use `/guardian-cleanup`)
- ‚ùå Does NOT build Astro website (use `/guardian-deploy`)
- ‚ùå Does NOT diagnose health issues (use `/guardian-health`)

**Focus**: Git commit workflow only - analyzes changes, commits with perfect format.

## Constitutional Compliance

This command enforces:
- ‚úÖ Automatic commit type detection
- ‚úÖ Meaningful commit messages (not "Update files")
- ‚úÖ Constitutional branch naming
- ‚úÖ Branch preservation strategy
- ‚úÖ Proper merge strategy (--no-ff)
- ‚úÖ Claude Code attribution
