class o{container=null;autoScan=!0;constructor(){this.init()}async init(){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>this.setup()):this.setup()}async setup(){this.container=document.querySelector(".accessibility-validator"),this.container&&(this.autoScan=this.container.hasAttribute("data-auto-scan"),this.setupEventListeners(),this.autoScan&&setTimeout(()=>{this.runAccessibilityScan()},1e3))}setupEventListeners(){const e=document.getElementById("accessibility-scan-btn");e&&e.addEventListener("click",()=>this.runAccessibilityScan());const s=document.getElementById("accessibility-details-toggle"),t=document.getElementById("accessibility-details");s&&t&&s.addEventListener("click",()=>{const a=t.classList.contains("hidden");t.classList.toggle("hidden",!a),s.textContent=a?"Hide Details":"Show Details"})}async runAccessibilityScan(){try{const e=document.getElementById("accessibility-scan-btn");e&&(e.textContent="Scanning...",e.setAttribute("disabled","true"));const s=await this.performAccessibilityScan();this.updateResults(s),this.announceResults(s)}catch(e){console.error("Accessibility scan failed:",e),this.updateError("Accessibility scan failed. Please try again.")}finally{const e=document.getElementById("accessibility-scan-btn");e&&(e.textContent="Run Accessibility Scan",e.removeAttribute("disabled"))}}async performAccessibilityScan(){const e={score:0,totalChecks:6,passedChecks:0,issues:[],checks:{altText:{passed:!1,issues:[]},formLabels:{passed:!1,issues:[]},headingStructure:{passed:!1,issues:[]},colorContrast:{passed:!1,issues:[]},ariaLabels:{passed:!1,issues:[]},keyboardNav:{passed:!1,issues:[]}}};return e.checks.altText=this.checkAltText(),e.checks.altText.passed&&e.passedChecks++,e.checks.formLabels=this.checkFormLabels(),e.checks.formLabels.passed&&e.passedChecks++,e.checks.headingStructure=this.checkHeadingStructure(),e.checks.headingStructure.passed&&e.passedChecks++,e.checks.colorContrast=this.checkColorContrast(),e.checks.colorContrast.passed&&e.passedChecks++,e.checks.ariaLabels=this.checkAriaLabels(),e.checks.ariaLabels.passed&&e.passedChecks++,e.checks.keyboardNav=this.checkKeyboardNavigation(),e.checks.keyboardNav.passed&&e.passedChecks++,e.score=Math.round(e.passedChecks/e.totalChecks*100),Object.values(e.checks).forEach(s=>{e.issues.push(...s.issues.map(t=>({type:"accessibility",message:t})))}),e}checkAltText(){const e=document.querySelectorAll("img"),s=[];return e.forEach((t,a)=>{!t.alt&&!t.getAttribute("aria-label")&&!t.getAttribute("aria-labelledby")&&s.push(`Image ${a+1} missing alt text`)}),{passed:s.length===0,issues:s}}checkFormLabels(){const e=document.querySelectorAll("input, textarea, select"),s=[];return e.forEach((t,a)=>{if(!(t.getAttribute("aria-label")||t.getAttribute("aria-labelledby")||document.querySelector(`label[for="${t.id}"]`))){const c=t.tagName.toLowerCase();s.push(`${c} control ${a+1} missing accessible label`)}}),{passed:s.length===0,issues:s}}checkHeadingStructure(){const e=document.querySelectorAll("h1, h2, h3, h4, h5, h6"),s=[];let t=0;return e.forEach((a,i)=>{const c=parseInt(a.tagName.slice(1));i===0&&c!==1&&s.push("Page should start with h1 heading"),c>t+1&&s.push(`Heading level skipped: ${a.tagName} after h${t}`),t=c}),{passed:s.length===0,issues:s}}checkColorContrast(){const e=[],s=document.querySelectorAll("p, span, div, button, a");let t=0;return s.forEach(a=>{const i=window.getComputedStyle(a),c=i.backgroundColor,n=i.color;(c==="rgba(0, 0, 0, 0)"||c===n)&&t++}),t>0&&e.push(`${t} elements may have insufficient color contrast`),{passed:e.length===0,issues:e}}checkAriaLabels(){const e=document.querySelectorAll('button, a, [role="button"], [role="link"]'),s=[];return e.forEach((t,a)=>{if(!(t.getAttribute("aria-label")||t.getAttribute("aria-labelledby")||t.textContent?.trim()||t.getAttribute("title"))){const c=t.tagName.toLowerCase(),n=t.getAttribute("role")||c;s.push(`${n} element ${a+1} missing accessible name`)}}),{passed:s.length===0,issues:s}}checkKeyboardNavigation(){const e=document.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),s=[];return e.forEach((t,a)=>{const i=window.getComputedStyle(t);i.display==="none"||i.visibility==="hidden"||t.getAttribute("tabindex")==="-1"&&["button","a","input","select","textarea"].includes(t.tagName.toLowerCase())&&s.push(`Interactive element ${a+1} removed from keyboard navigation`)}),{passed:s.length===0,issues:s}}updateResults(e){const s=document.getElementById("accessibility-score");s&&(s.textContent=`${e.score}%`,s.className=e.score>=90?"text-green-600 font-bold":e.score>=70?"text-yellow-600 font-bold":"text-red-600 font-bold"),this.updateCheckStatus("alt-text-status",e.checks.altText.passed),this.updateCheckStatus("form-labels-status",e.checks.formLabels.passed),this.updateCheckStatus("heading-structure-status",e.checks.headingStructure.passed),this.updateCheckStatus("color-contrast-status",e.checks.colorContrast.passed),this.updateCheckStatus("aria-labels-status",e.checks.ariaLabels.passed),this.updateCheckStatus("keyboard-nav-status",e.checks.keyboardNav.passed),this.updateIssuesList(e.issues)}updateCheckStatus(e,s){const t=document.getElementById(e);t&&(t.textContent=s?"‚úÖ":"‚ùå",t.setAttribute("aria-label",s?"Passed":"Failed"))}updateIssuesList(e){const s=document.getElementById("issues-list");s&&(s.innerHTML="",e.length===0?s.innerHTML='<div class="text-green-600">No accessibility issues found! üéâ</div>':e.forEach(t=>{const a=document.createElement("div");a.className="p-2 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded text-red-800 dark:text-red-200",a.textContent=t.message,s.appendChild(a)}))}updateError(e){const s=document.getElementById("accessibility-score");s&&(s.textContent="Error",s.className="text-red-600 font-bold");const t=document.getElementById("issues-list");t&&(t.innerHTML=`<div class="text-red-600">${e}</div>`)}announceResults(e){const s=`Accessibility scan complete. Score: ${e.score}%. ${e.issues.length} issues found.`,t=document.createElement("div");t.setAttribute("aria-live","polite"),t.setAttribute("aria-atomic","true"),t.className="sr-only",t.textContent=s,document.body.appendChild(t),setTimeout(()=>{document.body.contains(t)&&document.body.removeChild(t)},1e3)}}new o;
