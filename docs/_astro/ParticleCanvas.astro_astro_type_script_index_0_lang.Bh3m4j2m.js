const a={particleCount:window.innerWidth<768?80:200,parallaxLayers:window.innerWidth<768?1:3,shootingStarInterval:{min:2e3,max:3e3},colors:["#ffffff","#38bdf8","#22d3ee","#a5f3fc"]};class l{constructor(t){this.canvas=t,this.reset()}x=0;y=0;vx=0;vy=0;size=1;opacity=1;layer=0;color="#ffffff";twinkleSpeed=0;twinkleOffset=0;reset(){this.x=Math.random()*this.canvas.width,this.y=Math.random()*this.canvas.height,this.layer=Math.floor(Math.random()*a.parallaxLayers);const t=(this.layer+1)*.15;this.vx=(Math.random()-.5)*t,this.vy=(Math.random()-.5)*t,this.size=(a.parallaxLayers-this.layer)*1.2+Math.random()*1.5,this.color=a.colors[Math.floor(Math.random()*a.colors.length)],this.twinkleSpeed=Math.random()*.02+.01,this.twinkleOffset=Math.random()*Math.PI*2,this.opacity=.3+Math.random()*.7}update(t,i,h){this.x+=this.vx,this.y+=this.vy,this.x<0&&(this.x=this.canvas.width),this.x>this.canvas.width&&(this.x=0),this.y<0&&(this.y=this.canvas.height),this.y>this.canvas.height&&(this.y=0);const s=this.x-i,e=this.y-h,r=Math.sqrt(s*s+e*e);if(r<150&&r>0){const o=(150-r)/150*.3;this.x+=s/r*o,this.y+=e/r*o}this.opacity=.4+Math.sin(t*this.twinkleSpeed+this.twinkleOffset)*.4+.2}draw(t){t.beginPath(),t.arc(this.x,this.y,this.size,0,Math.PI*2),t.fillStyle=this.color,t.globalAlpha=this.opacity,t.fill(),this.size>2&&(t.beginPath(),t.arc(this.x,this.y,this.size*2,0,Math.PI*2),t.fillStyle=this.color,t.globalAlpha=this.opacity*.2,t.fill())}}class c{constructor(t){this.canvas=t}x=0;y=0;vx=0;vy=0;length=0;trail=[];active=!1;opacity=1;spawn(){Math.random()>.5?(this.x=Math.random()*this.canvas.width,this.y=-20):(this.x=this.canvas.width+20,this.y=Math.random()*this.canvas.height*.5);const t=Math.PI*.6+Math.random()*.4,i=15+Math.random()*10;this.vx=Math.cos(t)*i,this.vy=Math.sin(t)*i,this.length=80+Math.random()*60,this.trail=[],this.active=!0,this.opacity=1}update(){this.active&&(this.trail.unshift({x:this.x,y:this.y,opacity:1}),this.trail.length>25&&this.trail.pop(),this.trail.forEach((t,i)=>{t.opacity=1-i/this.trail.length}),this.x+=this.vx,this.y+=this.vy,(this.x<-100||this.y>this.canvas.height+100)&&(this.active=!1))}draw(t){if(!this.active||this.trail.length<2)return;t.beginPath(),t.moveTo(this.trail[0].x,this.trail[0].y);for(let h=1;h<this.trail.length;h++)t.lineTo(this.trail[h].x,this.trail[h].y);const i=t.createLinearGradient(this.trail[0].x,this.trail[0].y,this.trail[this.trail.length-1].x,this.trail[this.trail.length-1].y);i.addColorStop(0,"rgba(255, 255, 255, 1)"),i.addColorStop(.3,"rgba(56, 189, 248, 0.8)"),i.addColorStop(1,"rgba(56, 189, 248, 0)"),t.strokeStyle=i,t.lineWidth=2,t.lineCap="round",t.globalAlpha=this.opacity,t.stroke(),t.beginPath(),t.arc(this.x,this.y,3,0,Math.PI*2),t.fillStyle="#ffffff",t.globalAlpha=1,t.fill()}}class d{canvas;ctx;particles=[];shootingStars=[];animationId=0;lastTime=0;mouseX=0;mouseY=0;running=!1;shootingStarTimer=0;constructor(t){const i=document.getElementById(t);if(!i)throw new Error("Canvas not found");this.canvas=i,this.ctx=i.getContext("2d"),this.handleResize(),this.initParticles(),this.setupEventListeners()}handleResize=()=>{const t=window.devicePixelRatio||1,i=this.canvas.getBoundingClientRect();this.canvas.width=i.width*t,this.canvas.height=i.height*t,this.ctx.scale(t,t),this.canvas.style.width=`${i.width}px`,this.canvas.style.height=`${i.height}px`};initParticles(){this.particles=[];for(let t=0;t<a.particleCount;t++)this.particles.push(new l(this.canvas));this.shootingStars=[];for(let t=0;t<3;t++)this.shootingStars.push(new c(this.canvas))}setupEventListeners(){window.addEventListener("resize",()=>{this.handleResize(),this.particles.forEach(t=>t.reset())}),document.addEventListener("mousemove",t=>{this.mouseX=t.clientX,this.mouseY=t.clientY}),document.addEventListener("visibilitychange",()=>{document.hidden?this.stop():this.start()})}spawnShootingStar(){const t=this.shootingStars.find(i=>!i.active);t&&t.spawn()}animate=t=>{if(!this.running)return;const i=t-this.lastTime;this.lastTime=t,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.globalAlpha=1,this.shootingStarTimer+=i;const h=a.shootingStarInterval.min+Math.random()*(a.shootingStarInterval.max-a.shootingStarInterval.min);this.shootingStarTimer>h&&(this.spawnShootingStar(),this.shootingStarTimer=0);for(let s=0;s<a.parallaxLayers;s++)this.particles.filter(e=>e.layer===s).forEach(e=>{e.update(t,this.mouseX,this.mouseY),e.draw(this.ctx)});this.shootingStars.forEach(s=>{s.update(),s.draw(this.ctx)}),this.animationId=requestAnimationFrame(this.animate)};start(){this.running||(this.running=!0,this.lastTime=performance.now(),this.animationId=requestAnimationFrame(this.animate))}stop(){this.running=!1,this.animationId&&cancelAnimationFrame(this.animationId)}}document.addEventListener("DOMContentLoaded",()=>{try{new d("particle-canvas").start()}catch(n){console.warn("ParticleCanvas initialization failed:",n)}});
